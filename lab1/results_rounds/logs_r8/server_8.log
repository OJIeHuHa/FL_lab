/home/rohovyi/DFL/lab1/data_utils.py:28: DeprecationWarning: __array__ implementation doesn't accept a copy keyword, so passing copy=False failed. __array__ must implement 'dtype' and 'copy' keyword arguments.
  targets = np.array(full_dataset.targets)
Number of clients: 10
Client 0 has 6271 samples
Client 1 has 7537 samples
Client 2 has 5075 samples
Client 3 has 4318 samples
Client 4 has 7426 samples
Client 5 has 3281 samples
Client 6 has 7385 samples
Client 7 has 7043 samples
Client 8 has 5536 samples
Client 9 has 6128 samples
Generated datasets for 10 clients with alpha=1
Waiting for clients to connect before starting training...
Starting server on 127.0.0.1:8080 for 8 rounds
[93mWARNING [0m:   DEPRECATED FEATURE: flwr.server.start_server() is deprecated.
	Instead, use the `flower-superlink` CLI command to start a SuperLink as shown below:

		$ flower-superlink --insecure

	To view usage and all available options, run:

		$ flower-superlink --help

	Using `start_server()` is deprecated.

            This is a deprecated feature. It will be removed
            entirely in future versions of Flower.
        
[92mINFO [0m:      Starting Flower server, config: num_rounds=8, round_timeout=60s
[92mINFO [0m:      Flower ECE: gRPC server running (8 rounds), SSL is disabled
[92mINFO [0m:      [INIT]
[92mINFO [0m:      Using initial global parameters provided by strategy
[92mINFO [0m:      Starting evaluation of initial global parameters
[92mINFO [0m:      Evaluation returned no results (`None`)
[92mINFO [0m:      
[92mINFO [0m:      [ROUND 1]
Waiting for clients in round 1: 0/10 connected...
Waiting for clients in round 1: 0/10 connected...
Waiting for clients in round 1: 0/10 connected...
Waiting for clients in round 1: 0/10 connected...
[CustomClientManager] Client 3709430d56ba4508ad553307d71e5ac5 registered.
[CustomClientManager] Client 30af38262b1f422d8aa09ef9d6e97609 registered.
[CustomClientManager] Client f23f4ea2fbdc4bc2b0f5e3c4d6ae7c3f registered.
Waiting for clients in round 1: 3/10 connected...
[CustomClientManager] Client 588632b521d845758e9f7df929105be1 registered.
[CustomClientManager] Client 590352c680ac4e519bbec560f0c49540 registered.
[CustomClientManager] Client afc60fb37c1242a5873f39eceb5ee657 registered.
[CustomClientManager] Client fb0690914088447ca3f18ed2f6c78cef registered.
[CustomClientManager] Client 5a43a9f4b4464a0fba09249767285b25 registered.
Waiting for clients in round 1: 8/10 connected...
[CustomClientManager] Client c9d2f41e2880464db2ff02100d6d7ace registered.
[CustomClientManager] Client 26c2ae04f3c34442b36b1a6f665484b9 registered.
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures

[Round 1] Fit results from clients:
 - Client fb0690914088447ca3f18ed2f6c78cef: Loss: 1.2214, Accuracy: 0.6408, Examples: 5908
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 1.5477, Accuracy: 0.4769, Examples: 5940
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 1.6366, Accuracy: 0.4916, Examples: 6029
 - Client 26c2ae04f3c34442b36b1a6f665484b9: Loss: 1.4260, Accuracy: 0.5439, Examples: 4902
 - Client 3709430d56ba4508ad553307d71e5ac5: Loss: 1.3926, Accuracy: 0.5341, Examples: 5016
[Round 1] Aggregated training metrics: {'loss': 1.448158986453938, 'accuracy': 0.5370750134916352}

[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures

[Round 1] Evaluation results from clients:
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 1.6253, Accuracy: 0.4781, Examples: 1508
 - Client 588632b521d845758e9f7df929105be1: Loss: 1.6333, Accuracy: 0.4988, Examples: 864
 - Client c9d2f41e2880464db2ff02100d6d7ace: Loss: 1.4885, Accuracy: 0.5117, Examples: 1108
 - Client f23f4ea2fbdc4bc2b0f5e3c4d6ae7c3f: Loss: 1.5616, Accuracy: 0.5232, Examples: 1015
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 1.4507, Accuracy: 0.5619, Examples: 1486
[Round 1] Aggregated evaluation metrics: {'loss': 1.54692484188032, 'accuracy': 0.5158000334392242}, Aggregated loss: 1.5469

[92mINFO [0m:      
[92mINFO [0m:      [ROUND 2]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures

[Round 2] Fit results from clients:
 - Client 26c2ae04f3c34442b36b1a6f665484b9: Loss: 0.7631, Accuracy: 0.7793, Examples: 4902
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 0.9773, Accuracy: 0.6863, Examples: 6029
 - Client fb0690914088447ca3f18ed2f6c78cef: Loss: 0.7158, Accuracy: 0.7861, Examples: 5908
 - Client 5a43a9f4b4464a0fba09249767285b25: Loss: 0.7512, Accuracy: 0.7879, Examples: 5634
 - Client 3709430d56ba4508ad553307d71e5ac5: Loss: 0.8756, Accuracy: 0.7020, Examples: 5016
[Round 2] Aggregated training metrics: {'loss': 0.8180061541141291, 'accuracy': 0.7480082942267816}

[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures

[Round 2] Evaluation results from clients:
 - Client c9d2f41e2880464db2ff02100d6d7ace: Loss: 0.9475, Accuracy: 0.6588, Examples: 1108
 - Client fb0690914088447ca3f18ed2f6c78cef: Loss: 0.8189, Accuracy: 0.7515, Examples: 1477
 - Client 588632b521d845758e9f7df929105be1: Loss: 0.9841, Accuracy: 0.6424, Examples: 864
 - Client afc60fb37c1242a5873f39eceb5ee657: Loss: 0.9449, Accuracy: 0.6362, Examples: 657
 - Client 3709430d56ba4508ad553307d71e5ac5: Loss: 1.0495, Accuracy: 0.6024, Examples: 1255
[Round 2] Aggregated evaluation metrics: {'loss': 0.941549998736386, 'accuracy': 0.6657340048498415}, Aggregated loss: 0.9415

[92mINFO [0m:      
[92mINFO [0m:      [ROUND 3]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures

[Round 3] Fit results from clients:
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 0.7737, Accuracy: 0.7236, Examples: 5940
 - Client 588632b521d845758e9f7df929105be1: Loss: 0.5700, Accuracy: 0.8379, Examples: 3454
 - Client fb0690914088447ca3f18ed2f6c78cef: Loss: 0.5224, Accuracy: 0.8387, Examples: 5908
 - Client c9d2f41e2880464db2ff02100d6d7ace: Loss: 0.6542, Accuracy: 0.7800, Examples: 4428
 - Client 5a43a9f4b4464a0fba09249767285b25: Loss: 0.5275, Accuracy: 0.8378, Examples: 5634
[Round 3] Aggregated training metrics: {'loss': 0.6118761840217818, 'accuracy': 0.8011748935499132}

[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures

[Round 3] Evaluation results from clients:
 - Client f23f4ea2fbdc4bc2b0f5e3c4d6ae7c3f: Loss: 0.8161, Accuracy: 0.6975, Examples: 1015
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 1.0631, Accuracy: 0.5491, Examples: 1486
 - Client 3709430d56ba4508ad553307d71e5ac5: Loss: 0.9315, Accuracy: 0.6191, Examples: 1255
 - Client afc60fb37c1242a5873f39eceb5ee657: Loss: 0.8308, Accuracy: 0.6591, Examples: 657
 - Client 588632b521d845758e9f7df929105be1: Loss: 0.6484, Accuracy: 0.7801, Examples: 864
[Round 3] Aggregated evaluation metrics: {'loss': 0.8874714214150734, 'accuracy': 0.6458214894826606}, Aggregated loss: 0.8875

[92mINFO [0m:      
[92mINFO [0m:      [ROUND 4]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures

[Round 4] Fit results from clients:
 - Client f23f4ea2fbdc4bc2b0f5e3c4d6ae7c3f: Loss: 0.6786, Accuracy: 0.7616, Examples: 4060
 - Client 5a43a9f4b4464a0fba09249767285b25: Loss: 0.4599, Accuracy: 0.8518, Examples: 5634
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 0.6868, Accuracy: 0.7530, Examples: 5940
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 0.6700, Accuracy: 0.7617, Examples: 6029
 - Client afc60fb37c1242a5873f39eceb5ee657: Loss: 0.6005, Accuracy: 0.7889, Examples: 2624
[Round 4] Aggregated training metrics: {'loss': 0.6192963323975206, 'accuracy': 0.7833820562440812}

[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures

[Round 4] Evaluation results from clients:
 - Client fb0690914088447ca3f18ed2f6c78cef: Loss: 0.6960, Accuracy: 0.7448, Examples: 1477
 - Client 3709430d56ba4508ad553307d71e5ac5: Loss: 0.7427, Accuracy: 0.7378, Examples: 1255
 - Client f23f4ea2fbdc4bc2b0f5e3c4d6ae7c3f: Loss: 0.6786, Accuracy: 0.7458, Examples: 1015
 - Client 26c2ae04f3c34442b36b1a6f665484b9: Loss: 0.5491, Accuracy: 0.8279, Examples: 1226
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 0.7377, Accuracy: 0.7407, Examples: 1508
[Round 4] Aggregated evaluation metrics: {'loss': 0.6842215102297567, 'accuracy': 0.7583706218176207}, Aggregated loss: 0.6842

[92mINFO [0m:      
[92mINFO [0m:      [ROUND 5]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures

[Round 5] Fit results from clients:
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 0.6235, Accuracy: 0.7754, Examples: 5940
 - Client 26c2ae04f3c34442b36b1a6f665484b9: Loss: 0.4008, Accuracy: 0.8713, Examples: 4902
 - Client 588632b521d845758e9f7df929105be1: Loss: 0.4186, Accuracy: 0.8755, Examples: 3454
 - Client 3709430d56ba4508ad553307d71e5ac5: Loss: 0.5643, Accuracy: 0.7879, Examples: 5016
 - Client afc60fb37c1242a5873f39eceb5ee657: Loss: 0.5494, Accuracy: 0.8014, Examples: 2624
[Round 5] Aggregated training metrics: {'loss': 0.5190644688723591, 'accuracy': 0.8185630926331146}

[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures

[Round 5] Evaluation results from clients:
 - Client c9d2f41e2880464db2ff02100d6d7ace: Loss: 0.5965, Accuracy: 0.7590, Examples: 1108
 - Client fb0690914088447ca3f18ed2f6c78cef: Loss: 0.7347, Accuracy: 0.7211, Examples: 1477
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 0.6931, Accuracy: 0.7606, Examples: 1508
 - Client 3709430d56ba4508ad553307d71e5ac5: Loss: 0.5980, Accuracy: 0.7992, Examples: 1255
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 0.6722, Accuracy: 0.7759, Examples: 1486
[Round 5] Aggregated evaluation metrics: {'loss': 0.6644318788101145, 'accuracy': 0.7622183201638865}, Aggregated loss: 0.6644

[92mINFO [0m:      
[92mINFO [0m:      [ROUND 6]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures

[Round 6] Fit results from clients:
 - Client afc60fb37c1242a5873f39eceb5ee657: Loss: 0.5105, Accuracy: 0.8190, Examples: 2624
 - Client 3709430d56ba4508ad553307d71e5ac5: Loss: 0.5239, Accuracy: 0.8072, Examples: 5016
 - Client 588632b521d845758e9f7df929105be1: Loss: 0.3894, Accuracy: 0.8798, Examples: 3454
 - Client c9d2f41e2880464db2ff02100d6d7ace: Loss: 0.4833, Accuracy: 0.8252, Examples: 4428
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 0.5836, Accuracy: 0.7891, Examples: 5940
[Round 6] Aggregated training metrics: {'loss': 0.5087418790929927, 'accuracy': 0.8190289814555959}

[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures

[Round 6] Evaluation results from clients:
 - Client 3709430d56ba4508ad553307d71e5ac5: Loss: 0.5563, Accuracy: 0.8000, Examples: 1255
 - Client 26c2ae04f3c34442b36b1a6f665484b9: Loss: 0.5715, Accuracy: 0.8116, Examples: 1226
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 0.6259, Accuracy: 0.7900, Examples: 1486
 - Client 588632b521d845758e9f7df929105be1: Loss: 0.4808, Accuracy: 0.8391, Examples: 864
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 0.6851, Accuracy: 0.7606, Examples: 1508
[Round 6] Aggregated evaluation metrics: {'loss': 0.5959200847034181, 'accuracy': 0.7958668559709733}, Aggregated loss: 0.5959

[92mINFO [0m:      
[92mINFO [0m:      [ROUND 7]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures

[Round 7] Fit results from clients:
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 0.5589, Accuracy: 0.7975, Examples: 5940
 - Client 588632b521d845758e9f7df929105be1: Loss: 0.3685, Accuracy: 0.8871, Examples: 3454
 - Client afc60fb37c1242a5873f39eceb5ee657: Loss: 0.4781, Accuracy: 0.8228, Examples: 2624
 - Client fb0690914088447ca3f18ed2f6c78cef: Loss: 0.3795, Accuracy: 0.8676, Examples: 5908
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 0.5560, Accuracy: 0.8016, Examples: 6029
[Round 7] Aggregated training metrics: {'loss': 0.4776283286740501, 'accuracy': 0.831517428511793}

[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures

[Round 7] Evaluation results from clients:
 - Client afc60fb37c1242a5873f39eceb5ee657: Loss: 0.5811, Accuracy: 0.7884, Examples: 657
 - Client c9d2f41e2880464db2ff02100d6d7ace: Loss: 0.4963, Accuracy: 0.8159, Examples: 1108
 - Client f23f4ea2fbdc4bc2b0f5e3c4d6ae7c3f: Loss: 0.5967, Accuracy: 0.7793, Examples: 1015
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 0.6381, Accuracy: 0.7706, Examples: 1508
 - Client 26c2ae04f3c34442b36b1a6f665484b9: Loss: 0.4858, Accuracy: 0.8303, Examples: 1226
[Round 7] Aggregated evaluation metrics: {'loss': 0.5613203204581821, 'accuracy': 0.7966993108451215}, Aggregated loss: 0.5613

[92mINFO [0m:      
[92mINFO [0m:      [ROUND 8]
[92mINFO [0m:      configure_fit: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_fit: received 5 results and 0 failures

[Round 8] Fit results from clients:
 - Client afc60fb37c1242a5873f39eceb5ee657: Loss: 0.4626, Accuracy: 0.8262, Examples: 2624
 - Client 30af38262b1f422d8aa09ef9d6e97609: Loss: 0.5322, Accuracy: 0.8104, Examples: 6029
 - Client 26c2ae04f3c34442b36b1a6f665484b9: Loss: 0.3447, Accuracy: 0.8878, Examples: 4902
 - Client f23f4ea2fbdc4bc2b0f5e3c4d6ae7c3f: Loss: 0.5368, Accuracy: 0.8111, Examples: 4060
 - Client 590352c680ac4e519bbec560f0c49540: Loss: 0.5414, Accuracy: 0.8047, Examples: 5940
[Round 8] Aggregated training metrics: {'loss': 0.4885152130895196, 'accuracy': 0.8269581829760135}

[92mINFO [0m:      configure_evaluate: strategy sampled 5 clients (out of 10)
[92mINFO [0m:      aggregate_evaluate: received 5 results and 0 failures

[Round 8] Evaluation results from clients:
 - Client f23f4ea2fbdc4bc2b0f5e3c4d6ae7c3f: Loss: 0.5204, Accuracy: 0.8138, Examples: 1015
 - Client 588632b521d845758e9f7df929105be1: Loss: 0.4595, Accuracy: 0.8426, Examples: 864
 - Client 26c2ae04f3c34442b36b1a6f665484b9: Loss: 0.4219, Accuracy: 0.8564, Examples: 1226
 - Client 5a43a9f4b4464a0fba09249767285b25: Loss: 0.5560, Accuracy: 0.7942, Examples: 1409
 - Client c9d2f41e2880464db2ff02100d6d7ace: Loss: 0.5172, Accuracy: 0.7924, Examples: 1108
[Round 8] Aggregated evaluation metrics: {'loss': 0.4978452095121135, 'accuracy': 0.8183920313055852}, Aggregated loss: 0.4978

[92mINFO [0m:      
[92mINFO [0m:      [SUMMARY]
[92mINFO [0m:      Run finished 8 round(s) in 20.47s
[92mINFO [0m:      	History (loss, distributed):
[92mINFO [0m:      		round 1: 1.54692484188032
[92mINFO [0m:      		round 2: 0.941549998736386
[92mINFO [0m:      		round 3: 0.8874714214150734
[92mINFO [0m:      		round 4: 0.6842215102297567
[92mINFO [0m:      		round 5: 0.6644318788101145
[92mINFO [0m:      		round 6: 0.5959200847034181
[92mINFO [0m:      		round 7: 0.5613203204581821
[92mINFO [0m:      		round 8: 0.4978452095121135
[92mINFO [0m:      	History (metrics, distributed, fit):
[92mINFO [0m:      	{'accuracy': [(1, 0.5370750134916352),
[92mINFO [0m:      	              (2, 0.7480082942267816),
[92mINFO [0m:      	              (3, 0.8011748935499132),
[92mINFO [0m:      	              (4, 0.7833820562440812),
[92mINFO [0m:      	              (5, 0.8185630926331146),
[92mINFO [0m:      	              (6, 0.8190289814555959),
[92mINFO [0m:      	              (7, 0.831517428511793),
[92mINFO [0m:      	              (8, 0.8269581829760135)],
[92mINFO [0m:      	 'loss': [(1, 1.448158986453938),
[92mINFO [0m:      	          (2, 0.8180061541141291),
[92mINFO [0m:      	          (3, 0.6118761840217818),
[92mINFO [0m:      	          (4, 0.6192963323975206),
[92mINFO [0m:      	          (5, 0.5190644688723591),
[92mINFO [0m:      	          (6, 0.5087418790929927),
[92mINFO [0m:      	          (7, 0.4776283286740501),
[92mINFO [0m:      	          (8, 0.4885152130895196)]}
[92mINFO [0m:      	History (metrics, distributed, evaluate):
[92mINFO [0m:      	{'accuracy': [(1, 0.5158000334392242),
[92mINFO [0m:      	              (2, 0.6657340048498415),
[92mINFO [0m:      	              (3, 0.6458214894826606),
[92mINFO [0m:      	              (4, 0.7583706218176207),
[92mINFO [0m:      	              (5, 0.7622183201638865),
[92mINFO [0m:      	              (6, 0.7958668559709733),
[92mINFO [0m:      	              (7, 0.7966993108451215),
[92mINFO [0m:      	              (8, 0.8183920313055852)],
[92mINFO [0m:      	 'loss': [(1, 1.54692484188032),
[92mINFO [0m:      	          (2, 0.941549998736386),
[92mINFO [0m:      	          (3, 0.8874714214150734),
[92mINFO [0m:      	          (4, 0.6842215102297567),
[92mINFO [0m:      	          (5, 0.6644318788101145),
[92mINFO [0m:      	          (6, 0.5959200847034181),
[92mINFO [0m:      	          (7, 0.5613203204581821),
[92mINFO [0m:      	          (8, 0.4978452095121135)]}
[92mINFO [0m:      
[CustomClientManager] Client 3709430d56ba4508ad553307d71e5ac5 unregistered.
[CustomClientManager] Client 30af38262b1f422d8aa09ef9d6e97609 unregistered.
[CustomClientManager] Client f23f4ea2fbdc4bc2b0f5e3c4d6ae7c3f unregistered.
[CustomClientManager] Client 588632b521d845758e9f7df929105be1 unregistered.
[CustomClientManager] Client 590352c680ac4e519bbec560f0c49540 unregistered.
[CustomClientManager] Client fb0690914088447ca3f18ed2f6c78cef unregistered.
[CustomClientManager] Client afc60fb37c1242a5873f39eceb5ee657 unregistered.
[CustomClientManager] Client 5a43a9f4b4464a0fba09249767285b25 unregistered.
[CustomClientManager] Client c9d2f41e2880464db2ff02100d6d7ace unregistered.
[CustomClientManager] Client 26c2ae04f3c34442b36b1a6f665484b9 unregistered.
Saved training history to fl_history.json
Appended metadata and full eval loss list to plot1.json
Appended metadata and results to plot2.json
